<% layout('layout') %>

<div class="row justify-content-center">
  <div class="col-lg-8">
    <div class="card shadow-sm">
      <div class="card-body">
        <h1 class="h4 mb-3">Purchase Order Request</h1>
        <p class="text-muted mb-4">
          Fill this form to request a PO number. After submission, share the PO number with your vendor and include it on the invoice.
        </p>

        <% if (error) { %>
          <div class="alert alert-danger"><%= error %></div>
        <% } %>

        <% if (submitted && po) { %>
          <div class="alert alert-success">
            <strong>Request submitted!</strong><br />
            Your PO Number is:
            <span class="fw-bold"><%= po.poNumber %></span>
          </div>
        <% } %>

        <form method="POST" action="/request">
          <div class="mb-3">
            <label class="form-label">Requester Name *</label>
            <input type="text" name="requesterName" class="form-control" required />
          </div>

          <div class="mb-3">
            <label class="form-label">Requester Email</label>
            <input type="email" name="requesterEmail" class="form-control" />
          </div>

          <div class="mb-3">
            <label class="form-label">Division *</label>
            <select name="division" class="form-select" required>
              <option value="">Select...</option>
              <option value="FL">FL</option>
              <option value="GA ROOF">GA ROOF</option>
              <option value="OK">OK</option>
              <option value="GA SAV">GA SAV</option>
              <option value="OTHER">OTHER</option>
            </select>
          </div>

          <div class="mb-3">
            <label class="form-label">Vendor Name *</label>
            <input type="text" name="vendorName" class="form-control" required />
          </div>

          <div class="mb-3">
            <label class="form-label">Description of Purchase *</label>
            <textarea
              name="description"
              rows="3"
              class="form-control"
              placeholder="Example: Truck #214 repairs, hydraulic hose, etc."
              required
            ></textarea>
          </div>

          <div class="mb-3">
            <label class="form-label">Estimated Amount (USD) *</label>
            <input type="number" step="0.01" min="0" name="amount" class="form-control" required />
          </div>

          <button type="submit" class="btn btn-primary">
            Submit Request
          </button>
        </form>
      </div>
    </div>

    <% if (submitted && po) { %>
      <div class="card shadow-sm mt-4">
        <div class="card-body">
          <h2 class="h5 mb-3">Request Details</h2>
          <dl class="row mb-0">
            <dt class="col-sm-3">PO Number</dt>
            <dd class="col-sm-9"><code><%= po.poNumber %></code></dd>

            <dt class="col-sm-3">Requester</dt>
            <dd class="col-sm-9"><%= po.requesterName %></dd>

            <dt class="col-sm-3">Division</dt>
            <dd class="col-sm-9"><%= po.division %></dd>

            <dt class="col-sm-3">Vendor</dt>
            <dd class="col-sm-9"><%= po.vendorName %></dd>

            <dt class="col-sm-3">Amount</dt>
            <dd class="col-sm-9"><%= formatCurrency(po.amount) %></dd>

            <dt class="col-sm-3">Status</dt>
            <dd class="col-sm-9"><span class="badge bg-warning text-dark"><%= po.status %></span></dd>
          </dl>
        </div>
      </div>
    <% } %>
  </div>
</div>
